{"ast":null,"code":"const fieldsToMask = [\"password\", \"pwd\", \"secret\", \"password_confirmation\", \"passwordConfirmation\", \"cc\", \"card_number\", \"cardNumber\", \"ccv\", \"ssn\", \"credit_score\", \"creditScore\"];\n\n/**\n * Generates an object of fields to mask.\n *\n * We'll use an object because it's faster to check if a key exists in an object,\n * then it is to check if the key exists in an array.\n *\n * @param {string[]?} additionalFieldsToMask\n * @returns {object}\n */\nfunction generateFieldsToMaskMap() {\n  let additionalFieldsToMask = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  const fields = [...fieldsToMask, ...additionalFieldsToMask];\n  const fieldsMap = fields.reduce((acc, field) => {\n    acc[field] = true;\n    return acc;\n  }, {});\n  return fieldsMap;\n}\n\n/**\n * Takes an object representing the payload and masks its sensitive fields.\n *\n * @param {object} payloadObject\n * @returns {object}\n */\nfunction maskSensitiveValues(payloadObject, fieldsToMaskMap) {\n  if (typeof payloadObject === null) return null;\n  if (typeof payloadObject !== \"object\") return payloadObject;\n  if (Array.isArray(payloadObject)) {\n    return payloadObject.map(val => maskSensitiveValues(val, fieldsToMaskMap));\n  }\n  let objectToMask = {\n    ...payloadObject\n  };\n  let safeObject = Object.keys(objectToMask).reduce(function (acc, propName) {\n    if (typeof objectToMask[propName] === \"string\") {\n      if (fieldsToMaskMap[propName] === true) {\n        acc[propName] = \"*\".repeat(objectToMask[propName].length);\n      } else {\n        acc[propName] = objectToMask[propName];\n      }\n    } else if (Array.isArray(objectToMask[propName])) {\n      acc[propName] = objectToMask[propName].map(val => maskSensitiveValues(val, fieldsToMaskMap));\n    } else if (typeof objectToMask[propName] === \"object\") {\n      acc[propName] = maskSensitiveValues(objectToMask[propName], fieldsToMaskMap);\n    } else {\n      acc[propName] = objectToMask[propName];\n    }\n    return acc;\n  }, {});\n  return safeObject;\n}\nmodule.exports = {\n  generateFieldsToMaskMap,\n  maskSensitiveValues\n};","map":{"version":3,"names":["fieldsToMask","generateFieldsToMaskMap","additionalFieldsToMask","fields","fieldsMap","reduce","acc","field","maskSensitiveValues","payloadObject","fieldsToMaskMap","Array","isArray","map","val","objectToMask","safeObject","Object","keys","propName","repeat","length","module","exports"],"sources":["A:/Work/PersonalDevelopment/03 {React API}/api_app/node_modules/treblle/src/maskFields.js"],"sourcesContent":["const fieldsToMask = [\n  \"password\",\n  \"pwd\",\n  \"secret\",\n  \"password_confirmation\",\n  \"passwordConfirmation\",\n  \"cc\",\n  \"card_number\",\n  \"cardNumber\",\n  \"ccv\",\n  \"ssn\",\n  \"credit_score\",\n  \"creditScore\",\n];\n\n/**\n * Generates an object of fields to mask.\n *\n * We'll use an object because it's faster to check if a key exists in an object,\n * then it is to check if the key exists in an array.\n *\n * @param {string[]?} additionalFieldsToMask\n * @returns {object}\n */\nfunction generateFieldsToMaskMap(additionalFieldsToMask = []) {\n  const fields = [...fieldsToMask, ...additionalFieldsToMask];\n  const fieldsMap = fields.reduce((acc, field) => {\n    acc[field] = true;\n    return acc;\n  }, {});\n  return fieldsMap;\n}\n\n/**\n * Takes an object representing the payload and masks its sensitive fields.\n *\n * @param {object} payloadObject\n * @returns {object}\n */\nfunction maskSensitiveValues(payloadObject, fieldsToMaskMap) {\n  if (typeof payloadObject === null) return null;\n  if (typeof payloadObject !== \"object\") return payloadObject;\n  if (Array.isArray(payloadObject)) {\n    return payloadObject.map((val) =>\n      maskSensitiveValues(val, fieldsToMaskMap)\n    );\n  }\n\n  let objectToMask = { ...payloadObject };\n\n  let safeObject = Object.keys(objectToMask).reduce(function (acc, propName) {\n    if (typeof objectToMask[propName] === \"string\") {\n      if (fieldsToMaskMap[propName] === true) {\n        acc[propName] = \"*\".repeat(objectToMask[propName].length);\n      } else {\n        acc[propName] = objectToMask[propName];\n      }\n    } else if (Array.isArray(objectToMask[propName])) {\n      acc[propName] = objectToMask[propName].map((val) =>\n        maskSensitiveValues(val, fieldsToMaskMap)\n      );\n    } else if (typeof objectToMask[propName] === \"object\") {\n      acc[propName] = maskSensitiveValues(\n        objectToMask[propName],\n        fieldsToMaskMap\n      );\n    } else {\n      acc[propName] = objectToMask[propName];\n    }\n\n    return acc;\n  }, {});\n\n  return safeObject;\n}\n\nmodule.exports = {\n  generateFieldsToMaskMap,\n  maskSensitiveValues,\n};\n"],"mappings":"AAAA,MAAMA,YAAY,GAAG,CACnB,UAAU,EACV,KAAK,EACL,QAAQ,EACR,uBAAuB,EACvB,sBAAsB,EACtB,IAAI,EACJ,aAAa,EACb,YAAY,EACZ,KAAK,EACL,KAAK,EACL,cAAc,EACd,aAAa,CACd;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASC,uBAAuB,GAA8B;EAAA,IAA7BC,sBAAsB,uEAAG,EAAE;EAC1D,MAAMC,MAAM,GAAG,CAAC,GAAGH,YAAY,EAAE,GAAGE,sBAAsB,CAAC;EAC3D,MAAME,SAAS,GAAGD,MAAM,CAACE,MAAM,CAAC,CAACC,GAAG,EAAEC,KAAK,KAAK;IAC9CD,GAAG,CAACC,KAAK,CAAC,GAAG,IAAI;IACjB,OAAOD,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;EACN,OAAOF,SAAS;AAClB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAASI,mBAAmB,CAACC,aAAa,EAAEC,eAAe,EAAE;EAC3D,IAAI,OAAOD,aAAa,KAAK,IAAI,EAAE,OAAO,IAAI;EAC9C,IAAI,OAAOA,aAAa,KAAK,QAAQ,EAAE,OAAOA,aAAa;EAC3D,IAAIE,KAAK,CAACC,OAAO,CAACH,aAAa,CAAC,EAAE;IAChC,OAAOA,aAAa,CAACI,GAAG,CAAEC,GAAG,IAC3BN,mBAAmB,CAACM,GAAG,EAAEJ,eAAe,CAAC,CAC1C;EACH;EAEA,IAAIK,YAAY,GAAG;IAAE,GAAGN;EAAc,CAAC;EAEvC,IAAIO,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACH,YAAY,CAAC,CAACV,MAAM,CAAC,UAAUC,GAAG,EAAEa,QAAQ,EAAE;IACzE,IAAI,OAAOJ,YAAY,CAACI,QAAQ,CAAC,KAAK,QAAQ,EAAE;MAC9C,IAAIT,eAAe,CAACS,QAAQ,CAAC,KAAK,IAAI,EAAE;QACtCb,GAAG,CAACa,QAAQ,CAAC,GAAG,GAAG,CAACC,MAAM,CAACL,YAAY,CAACI,QAAQ,CAAC,CAACE,MAAM,CAAC;MAC3D,CAAC,MAAM;QACLf,GAAG,CAACa,QAAQ,CAAC,GAAGJ,YAAY,CAACI,QAAQ,CAAC;MACxC;IACF,CAAC,MAAM,IAAIR,KAAK,CAACC,OAAO,CAACG,YAAY,CAACI,QAAQ,CAAC,CAAC,EAAE;MAChDb,GAAG,CAACa,QAAQ,CAAC,GAAGJ,YAAY,CAACI,QAAQ,CAAC,CAACN,GAAG,CAAEC,GAAG,IAC7CN,mBAAmB,CAACM,GAAG,EAAEJ,eAAe,CAAC,CAC1C;IACH,CAAC,MAAM,IAAI,OAAOK,YAAY,CAACI,QAAQ,CAAC,KAAK,QAAQ,EAAE;MACrDb,GAAG,CAACa,QAAQ,CAAC,GAAGX,mBAAmB,CACjCO,YAAY,CAACI,QAAQ,CAAC,EACtBT,eAAe,CAChB;IACH,CAAC,MAAM;MACLJ,GAAG,CAACa,QAAQ,CAAC,GAAGJ,YAAY,CAACI,QAAQ,CAAC;IACxC;IAEA,OAAOb,GAAG;EACZ,CAAC,EAAE,CAAC,CAAC,CAAC;EAEN,OAAOU,UAAU;AACnB;AAEAM,MAAM,CAACC,OAAO,GAAG;EACftB,uBAAuB;EACvBO;AACF,CAAC"},"metadata":{},"sourceType":"script"}