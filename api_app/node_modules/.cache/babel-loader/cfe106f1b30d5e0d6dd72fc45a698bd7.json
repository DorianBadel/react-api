{"ast":null,"code":"var _jsxFileName = \"A:\\\\Work\\\\PersonalDevelopment\\\\03 {React API}\\\\api_app\\\\src\\\\api\\\\context\\\\authContext.tsx\",\n  _s = $RefreshSig$();\nimport React, { useReducer, createContext } from 'react';\nimport jwtDecode from 'jwt-decode';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  user: null\n};\nif (localStorage.getItem(\"token\")) {\n  const token = localStorage.getItem(\"token\");\n  const decodedToken = jwtDecode(token);\n  //! is added\n\n  if (decodedToken.exp * 1000 < Date.now()) {\n    localStorage.removeItem(\"token\");\n  } else {\n    initialState.user = decodedToken;\n  }\n}\nconst AuthContext = /*#__PURE__*/createContext({\n  user: null,\n  login: userData => {},\n  logout: () => {}\n});\nfunction authReducer(state, action) {\n  switch (action.type) {\n    case 'LOGIN':\n      return {\n        ...state,\n        user: action.payload\n      };\n    case 'LOGOUT':\n      return {\n        ...state,\n        user: null\n      };\n    default:\n      return state;\n  }\n}\nfunction AuthProvider(props) {\n  _s();\n  const [state, dispatch] = useReducer(authReducer, initialState);\n  const login = userData => {\n    localStorage.setItem(\"token\", userData.token);\n    dispatch({\n      type: 'LOGIN',\n      payload: userData\n    });\n  };\n  function logout() {\n    localStorage.removeItem(\"token\");\n    dispatch({\n      type: 'LOGOUT'\n    });\n  }\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user: state.user,\n      login,\n      logout\n    },\n    ...props\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthProvider, \"6JWkGZ32UPfojeNx+xqn8ZU8A0Q=\");\n_c = AuthProvider;\nexport { AuthContext, AuthProvider };\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","useReducer","createContext","jwtDecode","initialState","user","localStorage","getItem","token","decodedToken","exp","Date","now","removeItem","AuthContext","login","userData","logout","authReducer","state","action","type","payload","AuthProvider","props","dispatch","setItem"],"sources":["A:/Work/PersonalDevelopment/03 {React API}/api_app/src/api/context/authContext.tsx"],"sourcesContent":["import React, { useReducer, createContext} from 'react';\r\nimport jwtDecode from 'jwt-decode';\r\n\r\nconst initialState = {\r\n  user: null\r\n}\r\n\r\nif(localStorage.getItem(\"token\")){\r\n  const token:string = localStorage.getItem(\"token\")!;\r\n  const decodedToken: any = jwtDecode(token);\r\n  //! is added\r\n\r\n  if(decodedToken.exp * 1000 < Date.now()){\r\n    localStorage.removeItem(\"token\");\r\n  } else {\r\n    initialState.user = decodedToken;\r\n  }\r\n}\r\n\r\nconst AuthContext = createContext({\r\n  user: null,\r\n  login: (userData:any) => {},\r\n  logout: () => {}\r\n});\r\n\r\nfunction authReducer(state:any, action:any){\r\n  switch(action.type){\r\n    case 'LOGIN':\r\n      return {\r\n        ...state,\r\n        user: action.payload\r\n      }\r\n    case 'LOGOUT':\r\n      return {\r\n        ...state,\r\n        user: null\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction AuthProvider(props:any) {\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n\r\n  const login = (userData:any)  => {\r\n    localStorage.setItem(\"token\",userData.token);\r\n    dispatch({\r\n      type: 'LOGIN',\r\n      payload: userData\r\n    })\r\n  }\r\n\r\n  function logout(){\r\n    localStorage.removeItem(\"token\");\r\n    dispatch({\r\n      type: 'LOGOUT'\r\n    });\r\n  }\r\n\r\n  return(\r\n    <AuthContext.Provider\r\n      value={{user: state.user, login, logout}}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport {AuthContext, AuthProvider};"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,aAAa,QAAO,OAAO;AACvD,OAAOC,SAAS,MAAM,YAAY;AAAC;AAEnC,MAAMC,YAAY,GAAG;EACnBC,IAAI,EAAE;AACR,CAAC;AAED,IAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,EAAC;EAC/B,MAAMC,KAAY,GAAGF,YAAY,CAACC,OAAO,CAAC,OAAO,CAAE;EACnD,MAAME,YAAiB,GAAGN,SAAS,CAACK,KAAK,CAAC;EAC1C;;EAEA,IAAGC,YAAY,CAACC,GAAG,GAAG,IAAI,GAAGC,IAAI,CAACC,GAAG,EAAE,EAAC;IACtCN,YAAY,CAACO,UAAU,CAAC,OAAO,CAAC;EAClC,CAAC,MAAM;IACLT,YAAY,CAACC,IAAI,GAAGI,YAAY;EAClC;AACF;AAEA,MAAMK,WAAW,gBAAGZ,aAAa,CAAC;EAChCG,IAAI,EAAE,IAAI;EACVU,KAAK,EAAGC,QAAY,IAAK,CAAC,CAAC;EAC3BC,MAAM,EAAE,MAAM,CAAC;AACjB,CAAC,CAAC;AAEF,SAASC,WAAW,CAACC,KAAS,EAAEC,MAAU,EAAC;EACzC,QAAOA,MAAM,CAACC,IAAI;IAChB,KAAK,OAAO;MACV,OAAO;QACL,GAAGF,KAAK;QACRd,IAAI,EAAEe,MAAM,CAACE;MACf,CAAC;IACH,KAAK,QAAQ;MACX,OAAO;QACL,GAAGH,KAAK;QACRd,IAAI,EAAE;MACR,CAAC;IACH;MACE,OAAOc,KAAK;EAAC;AAEnB;AAEA,SAASI,YAAY,CAACC,KAAS,EAAE;EAAA;EAC/B,MAAM,CAACL,KAAK,EAAEM,QAAQ,CAAC,GAAGxB,UAAU,CAACiB,WAAW,EAAEd,YAAY,CAAC;EAE/D,MAAMW,KAAK,GAAIC,QAAY,IAAM;IAC/BV,YAAY,CAACoB,OAAO,CAAC,OAAO,EAACV,QAAQ,CAACR,KAAK,CAAC;IAC5CiB,QAAQ,CAAC;MACPJ,IAAI,EAAE,OAAO;MACbC,OAAO,EAAEN;IACX,CAAC,CAAC;EACJ,CAAC;EAED,SAASC,MAAM,GAAE;IACfX,YAAY,CAACO,UAAU,CAAC,OAAO,CAAC;IAChCY,QAAQ,CAAC;MACPJ,IAAI,EAAE;IACR,CAAC,CAAC;EACJ;EAEA,oBACE,QAAC,WAAW,CAAC,QAAQ;IACnB,KAAK,EAAE;MAAChB,IAAI,EAAEc,KAAK,CAACd,IAAI;MAAEU,KAAK;MAAEE;IAAM,CAAE;IAAA,GACrCO;EAAK;IAAA;IAAA;IAAA;EAAA,QACT;AAEN;AAAC,GAxBQD,YAAY;AAAA,KAAZA,YAAY;AA0BrB,SAAQT,WAAW,EAAES,YAAY;AAAE;AAAA"},"metadata":{},"sourceType":"module"}