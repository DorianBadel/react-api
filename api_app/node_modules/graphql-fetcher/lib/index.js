'use strict';
Object.defineProperty(exports, "__esModule", {
  value: true
});

var _stringify = require('babel-runtime/core-js/json/stringify');

var _stringify2 = _interopRequireDefault(_stringify);

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = function (_ref) {
  var fetch = _ref.fetch;
  var defaultHeaders = _ref.headers;
  var defaultMethod = _ref.method;
  var url = _ref.url;
  return function (graphQLParams) {
    var _ref2 = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var headers = _ref2.headers;
    var method = _ref2.method;
    return fetch(url, {
      method: method || defaultMethod || 'POST',
      headers: (0, _extends3.default)({
        Accept: 'application/json',
        'Content-Type': 'application/json'
      }, defaultHeaders, headers),
      body: (0, _stringify2.default)(graphQLParams),
      credentials: 'include'
    }).then(function (response) {
      return response.text();
    }).then(function (responseBody) {
      try {
        return JSON.parse(responseBody);
      } catch (error) {
        return responseBody;
      }
    });
  };
};